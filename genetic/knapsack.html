<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>a4be78ed82d1442dade72ba90b445f41</title>
  <style>
    html {
      line-height: 1.5;
      font-family: Georgia, serif;
      font-size: 20px;
      color: #1a1a1a;
      background-color: #fdfdfd;
    }
    body {
      margin: 0 auto;
      max-width: 36em;
      padding-left: 50px;
      padding-right: 50px;
      padding-top: 50px;
      padding-bottom: 50px;
      hyphens: auto;
      overflow-wrap: break-word;
      text-rendering: optimizeLegibility;
      font-kerning: normal;
    }
    @media (max-width: 600px) {
      body {
        font-size: 0.9em;
        padding: 1em;
      }
      h1 {
        font-size: 1.8em;
      }
    }
    @media print {
      body {
        background-color: transparent;
        color: black;
        font-size: 12pt;
      }
      p, h2, h3 {
        orphans: 3;
        widows: 3;
      }
      h2, h3, h4 {
        page-break-after: avoid;
      }
    }
    p {
      margin: 1em 0;
    }
    a {
      color: #1a1a1a;
    }
    a:visited {
      color: #1a1a1a;
    }
    img {
      max-width: 100%;
    }
    h1, h2, h3, h4, h5, h6 {
      margin-top: 1.4em;
    }
    h5, h6 {
      font-size: 1em;
      font-style: italic;
    }
    h6 {
      font-weight: normal;
    }
    ol, ul {
      padding-left: 1.7em;
      margin-top: 1em;
    }
    li > ol, li > ul {
      margin-top: 0;
    }
    blockquote {
      margin: 1em 0 1em 1.7em;
      padding-left: 1em;
      border-left: 2px solid #e6e6e6;
      color: #606060;
    }
    code {
      font-family: Menlo, Monaco, 'Lucida Console', Consolas, monospace;
      font-size: 85%;
      margin: 0;
    }
    pre {
      margin: 1em 0;
      overflow: auto;
    }
    pre code {
      padding: 0;
      overflow: visible;
      overflow-wrap: normal;
    }
    .sourceCode {
     background-color: transparent;
     overflow: visible;
    }
    hr {
      background-color: #1a1a1a;
      border: none;
      height: 1px;
      margin: 1em 0;
    }
    table {
      margin: 1em 0;
      border-collapse: collapse;
      width: 100%;
      overflow-x: auto;
      display: block;
      font-variant-numeric: lining-nums tabular-nums;
    }
    table caption {
      margin-bottom: 0.75em;
    }
    tbody {
      margin-top: 0.5em;
      border-top: 1px solid #1a1a1a;
      border-bottom: 1px solid #1a1a1a;
    }
    th {
      border-top: 1px solid #1a1a1a;
      padding: 0.25em 0.5em 0.25em 0.5em;
    }
    td {
      padding: 0.125em 0.5em 0.25em 0.5em;
    }
    header {
      margin-bottom: 4em;
      text-align: center;
    }
    #TOC li {
      list-style: none;
    }
    #TOC ul {
      padding-left: 1.3em;
    }
    #TOC > ul {
      padding-left: 0;
    }
    #TOC a:not(:hover) {
      text-decoration: none;
    }
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      {   }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span.al { color: #ff0000; font-weight: bold; } /* Alert */
    code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
    code span.at { color: #7d9029; } /* Attribute */
    code span.bn { color: #40a070; } /* BaseN */
    code span.bu { color: #008000; } /* BuiltIn */
    code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #4070a0; } /* Char */
    code span.cn { color: #880000; } /* Constant */
    code span.co { color: #60a0b0; font-style: italic; } /* Comment */
    code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
    code span.do { color: #ba2121; font-style: italic; } /* Documentation */
    code span.dt { color: #902000; } /* DataType */
    code span.dv { color: #40a070; } /* DecVal */
    code span.er { color: #ff0000; font-weight: bold; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #40a070; } /* Float */
    code span.fu { color: #06287e; } /* Function */
    code span.im { color: #008000; font-weight: bold; } /* Import */
    code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
    code span.kw { color: #007020; font-weight: bold; } /* Keyword */
    code span.op { color: #666666; } /* Operator */
    code span.ot { color: #007020; } /* Other */
    code span.pp { color: #bc7a00; } /* Preprocessor */
    code span.sc { color: #4070a0; } /* SpecialChar */
    code span.ss { color: #bb6688; } /* SpecialString */
    code span.st { color: #4070a0; } /* String */
    code span.va { color: #19177c; } /* Variable */
    code span.vs { color: #4070a0; } /* VerbatimString */
    code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
    .display.math{display: block; text-align: center; margin: 0.5rem auto;}
  </style>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<div class="cell code" data-execution_count="15">
<div class="sourceCode" id="cb1"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> random </span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> csv</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="16">
<div class="sourceCode" id="cb2"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>CROSSOVER_PROBABILITY <span class="op">=</span> <span class="fl">0.8</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>MUTATION_PROBABILITY <span class="op">=</span> <span class="fl">0.05</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>CARRY_PERCENTAGE <span class="op">=</span> <span class="fl">0.2</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>POPULATION_SIZE <span class="op">=</span> <span class="dv">100</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>MULTI_START_COUNT <span class="op">=</span> <span class="dv">10</span></span></code></pre></div>
</div>
<div class="cell markdown">
<h1>Part 0 : Read inputs from CSV file</h1>
<p>it is look very simple. we just can use <b style="color:blue">csv library</b> and its methods to extract first row of file from hole rows and save the others in list namsd snacks</p>
</div>
<div class="cell code" data-execution_count="17">
<div class="sourceCode" id="cb3"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>snacks <span class="op">=</span> []</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> <span class="bu">open</span>(<span class="st">&quot;snacks.csv&quot;</span> , <span class="st">&#39;r&#39;</span>) <span class="im">as</span> <span class="bu">file</span>:</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>    csvreader <span class="op">=</span> csv.reader(<span class="bu">file</span>)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>    header <span class="op">=</span> <span class="bu">next</span>(csvreader)</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> row <span class="kw">in</span> csvreader:</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>        snacks.append(row)</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="bu">file</span>.close()</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(snacks)</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a><span class="bu">len</span>(snacks)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>[[&#39;MazMaz&#39;, &#39;10&#39;, &#39;10&#39;], [&#39;Doogh-e-Abali&#39;, &#39;15&#39;, &#39;10&#39;], [&#39;Nani&#39;, &#39;5&#39;, &#39;5&#39;], [&#39;Jooj&#39;, &#39;7&#39;, &#39;15&#39;], [&#39;Hot-Dog&#39;, &#39;20&#39;, &#39;15&#39;], [&#39;Chips&#39;, &#39;8&#39;, &#39;6&#39;], [&#39;Nooshaba&#39;, &#39;12&#39;, &#39;8&#39;], [&#39;Shokolat&#39;, &#39;6&#39;, &#39;7&#39;], [&#39;Chocoroll&#39;, &#39;9&#39;, &#39;12&#39;], [&#39;Cookies&#39;, &#39;11&#39;, &#39;11&#39;], [&#39;Abnabat&#39;, &#39;4&#39;, &#39;4&#39;], [&#39;Adams-Khersi&#39;, &#39;14&#39;, &#39;9&#39;], [&#39;Popcorn&#39;, &#39;16&#39;, &#39;13&#39;], [&#39;Pastil&#39;, &#39;3&#39;, &#39;7&#39;], [&#39;Tordilla&#39;, &#39;10&#39;, &#39;9&#39;], [&#39;Masghati&#39;, &#39;5&#39;, &#39;6&#39;], [&#39;Ghottab&#39;, &#39;7&#39;, &#39;10&#39;], [&#39;Saghe-Talaei&#39;, &#39;9&#39;, &#39;11&#39;], [&#39;Choob-Shoor&#39;, &#39;13&#39;, &#39;12&#39;]]
</code></pre>
</div>
<div class="output execute_result" data-execution_count="17">
<pre><code>19</code></pre>
</div>
</div>
<div class="cell markdown">
<h1>Part1: Basic Concepts</h1>
<p>Each gene will be considered as a number between 0 and 1. n-th gene correspond that we peak what ratio of n-th food and finaly Each chromosome will consist of some genes and the number of these genes will be same as number of foods or exactly number of rows in csv file<i>(exept first row)</i>.</p>
</div>
<div class="cell markdown">
<h1>Part2: initial Population</h1>
<p>the <b>POPULATION_SIZE</b> variable defined to set the population size.</p>
</div>
<div class="cell markdown">
<h1>Part3: Fitness Function</h1>
<p>there are 3 parameters in <b style="color:green">Fractional Knapsack</b> problem that we have them as input of our issue:</p>
<ul type="square">
    <li>MIN_VALUE</li>
    <li>MAX_WEIGHT</li>
    <li>SNACK_NUMBER_INTERVAL --> <i style="color:gray">(SNI an abbreviation)</i></li>
</ul>
<p>for the first item, if value of chromosome was bigger equal than min_value , it gets 1 point otherwise 0.</p>
<p>for the second item, if weight of chromosome was smaller equal than max_weight , it gets 1 point otherwise 0.</p>
<p>finaly for third and last item, we extract the posetive and non-zero elements of each chromosome which shows how many snacks we peak.if this value was not in SNI , that chromosome gives 0 point otherwhise gives 1 point.</p>
<p><b>at last we define the <span style="color:blue">Fitness
Function</span> as bellow:</b></p>
<p>$fitness = \sum{C_i} $</p>
<p>
<p>C1 = chromose.value &gt;= minValue ? 1 : 0<p> <p>C2 = chromose.weight
&lt;= maxWeight ? 1 : 0<p> <p>C3 = chromose.nonzeroElementsNumber in SNI
? 1 : 0<p></p>
<p>with this implementation , all of our soloution chromosomes will have fitnees(chromosome) <span>=</span> 3</p>
</div>
<div class="cell markdown">
<h1>Part4: implementing CrossOver and Mutation Function and create next Generation</h1>
<h2 style="color:blue">CrossOver</h2>
<p>for CrossOver function , first we generate a random number between 0 and 1. Then, for each pair of chromosomes in mating pool, if the number is more than CROSSOVER_PROBABILITY, we select the chromosomes for the next phase without any change. Otherwise, we swap the genes in the middle of two random points, between the chromosomes. In this case, we have created a pair of child chromosomes from their parents.</p>
<h2 style="color:blue">Mutation</h2>
<p>for Mutaion function , For each gene in each chromosome of the crossover pool, we generate a random number between 0 and 1. If the number is less than MUTATION_PROBABILITY, we change the gene to a random number between 0 and 1 otherwise the gene saves its previous value.</p>
</div>
<div class="cell markdown">
<h1>Part5: Running algorithm</h1>
<p>here is complete code for algorithm:</p>
</div>
<div class="cell code" data-execution_count="18">
<div class="sourceCode" id="cb6"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Knapsack:</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>    snacks_number : <span class="bu">int</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>    max_weight : <span class="bu">int</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>    gen_count : <span class="bu">int</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>    min_value : <span class="bu">int</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>    interval_begin : <span class="bu">int</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>    interval_end : <span class="bu">int</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>    population : <span class="bu">list</span>[<span class="bu">list</span>]</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>,snacks_number,max_weight,min_value,gen_count ,interval_begin , interval_end):</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.max_weight <span class="op">=</span> max_weight</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.min_value <span class="op">=</span> min_value</span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.snacks_number <span class="op">=</span> snacks_number</span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.interval_begin <span class="op">=</span> interval_begin</span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.interval_end <span class="op">=</span> interval_end</span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.gen_count <span class="op">=</span> gen_count</span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> makeFirstPopulation(<span class="va">self</span>) <span class="op">-&gt;</span> <span class="bu">list</span>[<span class="bu">list</span>]:</span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a>        population <span class="op">=</span> []</span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(POPULATION_SIZE):</span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a>            chromosome <span class="op">=</span> [<span class="dv">0</span>] <span class="op">*</span> <span class="va">self</span>.snacks_number</span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a>            randomInt <span class="op">=</span> random.randint(<span class="va">self</span>.interval_begin , <span class="va">self</span>.interval_end)</span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(randomInt):</span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a>                chromosome[j] <span class="op">=</span> random.randint(<span class="dv">0</span>,<span class="dv">100</span>)<span class="op">/</span><span class="dv">100</span></span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(randomInt , <span class="va">self</span>.snacks_number <span class="op">-</span> randomInt):</span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true" tabindex="-1"></a>                chromosome[j] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb6-27"><a href="#cb6-27" aria-hidden="true" tabindex="-1"></a>            random.shuffle(chromosome)</span>
<span id="cb6-28"><a href="#cb6-28" aria-hidden="true" tabindex="-1"></a>            population.append(chromosome)</span>
<span id="cb6-29"><a href="#cb6-29" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> population</span>
<span id="cb6-30"><a href="#cb6-30" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb6-31"><a href="#cb6-31" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> find_solution(<span class="va">self</span> , multi_start_count:<span class="bu">int</span> <span class="op">=</span> <span class="dv">1</span>)<span class="op">-&gt;</span> <span class="bu">tuple</span>[<span class="bu">list</span>,<span class="bu">bool</span>]:</span>
<span id="cb6-32"><a href="#cb6-32" aria-hidden="true" tabindex="-1"></a>        bestsolution <span class="op">=</span> <span class="va">None</span></span>
<span id="cb6-33"><a href="#cb6-33" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span> (multi_start_count):</span>
<span id="cb6-34"><a href="#cb6-34" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.population <span class="op">=</span> <span class="va">self</span>.makeFirstPopulation()</span>
<span id="cb6-35"><a href="#cb6-35" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span> (<span class="va">self</span>.gen_count):</span>
<span id="cb6-36"><a href="#cb6-36" aria-hidden="true" tabindex="-1"></a>                random.shuffle(<span class="va">self</span>.population)</span>
<span id="cb6-37"><a href="#cb6-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-38"><a href="#cb6-38" aria-hidden="true" tabindex="-1"></a>                fitness <span class="op">=</span> [<span class="va">self</span>.calculate_fitness(<span class="va">self</span>.population[i])<span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(POPULATION_SIZE)]</span>
<span id="cb6-39"><a href="#cb6-39" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> <span class="bu">max</span>(fitness)<span class="op">==</span><span class="dv">3</span>:</span>
<span id="cb6-40"><a href="#cb6-40" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">return</span> <span class="va">self</span>.population[fitness.index(<span class="dv">3</span>)] , <span class="va">True</span></span>
<span id="cb6-41"><a href="#cb6-41" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb6-42"><a href="#cb6-42" aria-hidden="true" tabindex="-1"></a>                bestchromosomes <span class="op">=</span> [x <span class="cf">for</span> _ , x <span class="kw">in</span> <span class="bu">sorted</span>(<span class="bu">zip</span>(fitness,<span class="va">self</span>.population),key<span class="op">=</span><span class="kw">lambda</span> pair : pair[<span class="dv">0</span>] , reverse<span class="op">=</span> <span class="va">True</span>)] </span>
<span id="cb6-43"><a href="#cb6-43" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> bestsolution <span class="kw">is</span> <span class="va">None</span> <span class="kw">or</span> <span class="va">self</span>.calculate_fitness(bestsolution) <span class="op">&lt;</span> <span class="va">self</span>.calculate_fitness(bestchromosomes[<span class="dv">0</span>]):</span>
<span id="cb6-44"><a href="#cb6-44" aria-hidden="true" tabindex="-1"></a>                    bestsolution <span class="op">=</span> bestchromosomes[<span class="dv">0</span>]</span>
<span id="cb6-45"><a href="#cb6-45" aria-hidden="true" tabindex="-1"></a>                carriedChromosomes <span class="op">=</span> []</span>
<span id="cb6-46"><a href="#cb6-46" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">0</span>,<span class="bu">int</span>(POPULATION_SIZE<span class="op">*</span>CARRY_PERCENTAGE)):</span>
<span id="cb6-47"><a href="#cb6-47" aria-hidden="true" tabindex="-1"></a>                    carriedChromosomes.append(bestchromosomes[i])</span>
<span id="cb6-48"><a href="#cb6-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-49"><a href="#cb6-49" aria-hidden="true" tabindex="-1"></a>                matingpool <span class="op">=</span> <span class="va">self</span>.create_mating_pool(bestchromosomes)</span>
<span id="cb6-50"><a href="#cb6-50" aria-hidden="true" tabindex="-1"></a>                crossoverpool <span class="op">=</span> <span class="va">self</span>.create_crossover_pool(matingpool)</span>
<span id="cb6-51"><a href="#cb6-51" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.population.clear()</span>
<span id="cb6-52"><a href="#cb6-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-53"><a href="#cb6-53" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span> (POPULATION_SIZE <span class="op">-</span> <span class="bu">int</span>(POPULATION_SIZE<span class="op">*</span>CARRY_PERCENTAGE)):</span>
<span id="cb6-54"><a href="#cb6-54" aria-hidden="true" tabindex="-1"></a>                    <span class="va">self</span>.population.append(<span class="va">self</span>.mutation(crossoverpool[i]))</span>
<span id="cb6-55"><a href="#cb6-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-56"><a href="#cb6-56" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.population.extend(carriedChromosomes)</span>
<span id="cb6-57"><a href="#cb6-57" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> bestsolution , <span class="va">False</span></span>
<span id="cb6-58"><a href="#cb6-58" aria-hidden="true" tabindex="-1"></a>     </span>
<span id="cb6-59"><a href="#cb6-59" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb6-60"><a href="#cb6-60" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> create_mating_pool(<span class="va">self</span>,bestchromosomes:<span class="bu">list</span>[<span class="bu">list</span>]) <span class="op">-&gt;</span> <span class="bu">list</span>[<span class="bu">list</span>]:</span>
<span id="cb6-61"><a href="#cb6-61" aria-hidden="true" tabindex="-1"></a>        ranks <span class="op">=</span> <span class="bu">list</span>(<span class="bu">reversed</span>(<span class="bu">range</span>(<span class="dv">1</span> , POPULATION_SIZE <span class="op">+</span> <span class="dv">1</span>)))</span>
<span id="cb6-62"><a href="#cb6-62" aria-hidden="true" tabindex="-1"></a>        matingpool <span class="op">=</span> []</span>
<span id="cb6-63"><a href="#cb6-63" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span> (POPULATION_SIZE):</span>
<span id="cb6-64"><a href="#cb6-64" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(ranks[i]):</span>
<span id="cb6-65"><a href="#cb6-65" aria-hidden="true" tabindex="-1"></a>                matingpool.append(bestchromosomes[i])</span>
<span id="cb6-66"><a href="#cb6-66" aria-hidden="true" tabindex="-1"></a>        random.shuffle(matingpool)</span>
<span id="cb6-67"><a href="#cb6-67" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> matingpool[:POPULATION_SIZE]</span>
<span id="cb6-68"><a href="#cb6-68" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb6-69"><a href="#cb6-69" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb6-70"><a href="#cb6-70" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> create_crossover_pool(<span class="va">self</span>, matingpool:<span class="bu">list</span>[<span class="bu">list</span>]) <span class="op">-&gt;</span> <span class="bu">list</span>[<span class="bu">list</span>]:</span>
<span id="cb6-71"><a href="#cb6-71" aria-hidden="true" tabindex="-1"></a>        crossoverpool <span class="op">=</span> []</span>
<span id="cb6-72"><a href="#cb6-72" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span> (<span class="dv">0</span> , <span class="bu">len</span>(matingpool)<span class="op">-</span><span class="dv">1</span> , <span class="dv">2</span>):</span>
<span id="cb6-73"><a href="#cb6-73" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> random.random() <span class="op">&gt;</span> CROSSOVER_PROBABILITY:</span>
<span id="cb6-74"><a href="#cb6-74" aria-hidden="true" tabindex="-1"></a>                crossoverpool.append(matingpool[i])</span>
<span id="cb6-75"><a href="#cb6-75" aria-hidden="true" tabindex="-1"></a>                crossoverpool.append(matingpool[i <span class="op">+</span> <span class="dv">1</span>])</span>
<span id="cb6-76"><a href="#cb6-76" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb6-77"><a href="#cb6-77" aria-hidden="true" tabindex="-1"></a>                child <span class="op">=</span> <span class="va">self</span>.crossover(matingpool[i],matingpool[i <span class="op">+</span> <span class="dv">1</span>])</span>
<span id="cb6-78"><a href="#cb6-78" aria-hidden="true" tabindex="-1"></a>                crossoverpool.extend(child)</span>
<span id="cb6-79"><a href="#cb6-79" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> crossoverpool</span>
<span id="cb6-80"><a href="#cb6-80" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb6-81"><a href="#cb6-81" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> crossover(<span class="va">self</span>, chromosome1:<span class="bu">list</span>,chromosome2:<span class="bu">list</span>) <span class="op">-&gt;</span> <span class="bu">tuple</span>[<span class="bu">list</span>,<span class="bu">list</span>]:</span>
<span id="cb6-82"><a href="#cb6-82" aria-hidden="true" tabindex="-1"></a>        breakpoint_one <span class="op">=</span> random.randint(<span class="dv">0</span>,<span class="va">self</span>.snacks_number <span class="op">-</span> <span class="dv">1</span>)</span>
<span id="cb6-83"><a href="#cb6-83" aria-hidden="true" tabindex="-1"></a>        breakpoint_two <span class="op">=</span> random.randint(<span class="dv">0</span>,<span class="va">self</span>.snacks_number <span class="op">-</span> <span class="dv">1</span>)</span>
<span id="cb6-84"><a href="#cb6-84" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> breakpoint_one <span class="op">&gt;</span> breakpoint_two:</span>
<span id="cb6-85"><a href="#cb6-85" aria-hidden="true" tabindex="-1"></a>            breakpoint_one , breakpoint_two <span class="op">=</span> breakpoint_two , breakpoint_one</span>
<span id="cb6-86"><a href="#cb6-86" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb6-87"><a href="#cb6-87" aria-hidden="true" tabindex="-1"></a>        chromosome1 <span class="op">=</span> <span class="bu">list</span>(chromosome1)</span>
<span id="cb6-88"><a href="#cb6-88" aria-hidden="true" tabindex="-1"></a>        chromosome2 <span class="op">=</span> <span class="bu">list</span>(chromosome2)</span>
<span id="cb6-89"><a href="#cb6-89" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span> (breakpoint_one,breakpoint_two):</span>
<span id="cb6-90"><a href="#cb6-90" aria-hidden="true" tabindex="-1"></a>            chromosome1[i] , chromosome2[i] <span class="op">=</span> chromosome2[i] , chromosome1[i]</span>
<span id="cb6-91"><a href="#cb6-91" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> chromosome1 , chromosome2</span>
<span id="cb6-92"><a href="#cb6-92" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb6-93"><a href="#cb6-93" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> mutation(<span class="va">self</span>,chromosome:<span class="bu">list</span>) <span class="op">-&gt;</span> <span class="bu">list</span>:</span>
<span id="cb6-94"><a href="#cb6-94" aria-hidden="true" tabindex="-1"></a>        chromosome <span class="op">=</span> <span class="bu">list</span>(chromosome)</span>
<span id="cb6-95"><a href="#cb6-95" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(chromosome)):</span>
<span id="cb6-96"><a href="#cb6-96" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> random.random() <span class="op">&lt;</span> MUTATION_PROBABILITY:</span>
<span id="cb6-97"><a href="#cb6-97" aria-hidden="true" tabindex="-1"></a>                chromosome[i] <span class="op">=</span> random.randint(<span class="dv">0</span>,<span class="dv">100</span>)<span class="op">/</span><span class="dv">100</span></span>
<span id="cb6-98"><a href="#cb6-98" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> chromosome</span>
<span id="cb6-99"><a href="#cb6-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-100"><a href="#cb6-100" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> calculate_fitness(<span class="va">self</span>,chromosome : <span class="bu">list</span>) <span class="op">-&gt;</span> <span class="bu">float</span>:</span>
<span id="cb6-101"><a href="#cb6-101" aria-hidden="true" tabindex="-1"></a>        chromosome_weight <span class="op">=</span> <span class="bu">sum</span>(<span class="bu">map</span>(<span class="kw">lambda</span> x : x[<span class="dv">0</span>]<span class="op">*</span>x[<span class="dv">1</span>] , <span class="bu">zip</span>([<span class="bu">eval</span>(snack[<span class="dv">1</span>])<span class="cf">for</span> snack <span class="kw">in</span> snacks], chromosome)))</span>
<span id="cb6-102"><a href="#cb6-102" aria-hidden="true" tabindex="-1"></a>        chromosome_value <span class="op">=</span> <span class="bu">sum</span>(<span class="bu">map</span>(<span class="kw">lambda</span> x : x[<span class="dv">0</span>]<span class="op">*</span>x[<span class="dv">1</span>] , <span class="bu">zip</span>([<span class="bu">eval</span>(snack[<span class="dv">2</span>])<span class="cf">for</span> snack <span class="kw">in</span> snacks], chromosome)))</span>
<span id="cb6-103"><a href="#cb6-103" aria-hidden="true" tabindex="-1"></a>        peaked_item_number <span class="op">=</span> <span class="bu">sum</span>(<span class="dv">1</span> <span class="cf">for</span> gene <span class="kw">in</span> chromosome <span class="cf">if</span> gene <span class="op">!=</span> <span class="dv">0</span>)</span>
<span id="cb6-104"><a href="#cb6-104" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> (<span class="va">self</span>.max_weight <span class="op">&gt;=</span> chromosome_weight ) <span class="op">+</span> (chromosome_value  <span class="op">&gt;=</span> <span class="va">self</span>.min_value) <span class="op">+</span> (<span class="va">self</span>.interval_begin <span class="op">&lt;=</span> peaked_item_number <span class="op">&lt;=</span> <span class="va">self</span>.interval_end)</span>
<span id="cb6-105"><a href="#cb6-105" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb6-106"><a href="#cb6-106" aria-hidden="true" tabindex="-1"></a>       </span>
<span id="cb6-107"><a href="#cb6-107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-108"><a href="#cb6-108" aria-hidden="true" tabindex="-1"></a>    </span></code></pre></div>
</div>
<div class="cell markdown">
<h1>Part6: Questions</h1>
<div style="border:2px solid gray">
<h1>1.What problems does a small or large primary population cause?</h1>
<p>If the population size is very small, the algorithm may not be able to find the best solution because it may not have enough chromosomes to select from. On the other hand, if the population size is very large, the algorithm may take a long time to find the best solution and it may be unnecessary to spend that much time.</p>
</div>
<div style="border:2px solid gray">
<h1>2.What happens if the population size increases in each generation?</h1>
<p>This may return better solution but increases the time complexity and the memory. Also, it is unnecessary to do this because we can remove the chromosomes with the lowest fitness from the population in order to keep the population size constant.</p></div>
<div style="border:2px solid gray">
<h1>3.What is the effects of crossover and mutation? Is it possible to use only one of them?</h1>
<p>Crossover is used to create new chromosomes from the existing chromosomes. Mutation is used to change the genes of the chromosomes. For examp if we use only crossover, the neightbor genes may be stay same all time. in the other side ,If we use only mutation, it can be very random to change each gene. so if we use only one of these two , we may not be able to find the best solution. It is important to note that the crossover and mutation probabilities should be chosen carefully. The crossover probability is usually at least 80% and the mutation probability is usually at most 5%.</p></div>
<div style="border:2px solid gray">
<h1>4.how we can reach to solution faster in this special problem?</h1>
<p>Fitness function, parameters such as the probability of crossover and mutation, and the population size should be chosen carefully. Also, the crossover and mutation functions can affect the performance of the algorithm.</p></div>
<div style="border:2px solid gray">
<h1>5.why chromosomes don't change after a while , and how we can solve it?</h1>
<p>A common problem in genetic algorithms is that it may stop at a local maximum instead of the global maximum. Mutation is a good way to solve this problem. Also, we can limit the number of generations in order to stop the algorithm if it is not converging. In this case, we may also use multi-start to increase the probability of finding the global maximum.</p></div>
<div style="border:2px solid gray">
<h1>6.how we can terminate algorithm if it doesn't return an appropriate solution?</h1>
<p>As mentioned in the previous question, we can limit the number of generations in order to stop the algorithm if there exists no solution. We can use the following formula for the generation limit:</p><div style="color:pink ;">GenLimit = 2 * POPULATION_SIZE * Number_of_Snacks</div></div>
<p><strong>Now we distinguish our parameter for problem:</strong></p>
</div>
<div class="cell code" data-execution_count="19">
<div class="sourceCode" id="cb7"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>MAX_W <span class="op">=</span> <span class="dv">10</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>MIN_V <span class="op">=</span> <span class="dv">12</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>Int_begin <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>Int_end <span class="op">=</span> <span class="dv">4</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>GenCount <span class="op">=</span> POPULATION_SIZE <span class="op">*</span> <span class="dv">2</span> <span class="op">*</span> <span class="bu">len</span>(snacks)</span></code></pre></div>
</div>
<div class="cell markdown">
<p>create instance using constructor and pass the parameter to it:</p>
</div>
<div class="cell code" data-execution_count="20">
<div class="sourceCode" id="cb8"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>knapsack <span class="op">=</span> Knapsack(<span class="bu">len</span>(snacks),MAX_W,MIN_V,GenCount,Int_begin,Int_end)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>solution , isFind <span class="op">=</span> knapsack.find_solution(<span class="dv">1</span>)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="kw">not</span> isFind:</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;No true solution found but the best solution is: &quot;</span>)</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="op">*</span>solution)</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a></span></code></pre></div>
<div class="output stream stdout">
<pre><code>0.08 0 0 0 0 0 0 0.12 0 0 0 0 0 0.77 0 0.86 0 0 0
</code></pre>
</div>
</div>
<div class="cell markdown">
<p>
<p>at last we just should print the result as we want:<p></p>
</div>
<div class="cell code" data-execution_count="21">
<div class="sourceCode" id="cb10"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>indexes <span class="op">=</span> [solution.index(ratio) <span class="cf">for</span> ratio <span class="kw">in</span> solution <span class="cf">if</span> ratio <span class="op">!=</span> <span class="dv">0</span>]</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>Total_Weight <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>Total_Value <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> index <span class="kw">in</span> indexes:</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>    Total_Value <span class="op">+=</span> solution[index] <span class="op">*</span> <span class="bu">eval</span>(snacks[index][<span class="dv">2</span>])</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>    Total_Weight <span class="op">+=</span> solution[index] <span class="op">*</span> <span class="bu">eval</span>(snacks[index][<span class="dv">1</span>])</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> index <span class="kw">in</span> indexes:</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(snacks[index][<span class="dv">0</span>] <span class="op">+</span> <span class="st">&quot; : &quot;</span> <span class="op">+</span> <span class="bu">str</span>(solution[index] <span class="op">*</span> <span class="bu">eval</span>(snacks[index][<span class="dv">1</span>])))</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Total Weight : &quot;</span> <span class="op">+</span> <span class="bu">str</span>(Total_Weight))</span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Total Value : &quot;</span> <span class="op">+</span> <span class="bu">str</span>(Total_Value))</span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a></span></code></pre></div>
<div class="output stream stdout">
<pre><code>MazMaz : 0.8
Shokolat : 0.72
Pastil : 2.31
Masghati : 4.3
Total Weight : 8.129999999999999
Total Value : 12.190000000000001
</code></pre>
</div>
</div>
</body>
</html>
